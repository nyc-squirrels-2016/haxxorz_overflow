<h2><%= @question.title %></h2>
<p>by <%= @question.user.username %></p>
<%= render partial: "upvote", locals: {question: @question}%>
<p>Question vote count: <%=@question.vote_count%></p>
<%= render partial: "downvote", locals: {question: @question}%>
<p><%= @question.body %></p>
<h4>Comments</h4>
<% @question.comments.each do |comment| %>
  <p>Comment vote count: <%=comment.vote_count%></p>
  <div class="question_comments_box">
    <%= comment.body %>
  </div>
<% end %>

<% if logged_in? %>
  <h4>Add a comment</h4>
  <%= form_for [@question, Comment.new] do |f| %>
    <div>
      <%= f.label :body %>
      <%= f.text_area :body %>
    </div>
    <div>
      <%= f.submit "Comment" %>
    </div>
  <% end %>
<% end %>

<% @question.answers.each do |answer| %>
  <fieldset><legend><%= answer.user.username %></legend>
    <p>Answer vote count: <%=answer.vote_count%></p>
    <%= answer.body %>
    <% if answer.comments.length > 0 %>
      <h4>Comments:</h4>
    <% end %>
    <ul>
      <% answer.comments.each do |comment| %>
        <p>Comment vote count: <%=comment.vote_count%>
        <li><%= comment.body %></li>
      <% end %>
    </ul>
    <% if logged_in? %>
      <%= form_for [@question, answer, Comment.new] do |f| %>
        <%= f.text_field :body %>
        <%= f.submit "Comment on this answer" %>
      <% end %>
    <% end %>
  </fieldset>
<% end %>

<% if logged_in? %>
  <h3>Answer this question</h3>
  <%= form_for [@question, Answer.new] do |f| %>
    <div>
      <%= f.label :body %>
      <%= f.text_area :body %>
    </div>
    <div>
      <%= f.submit "Answer" %>
    </div>
  <% end %>
<% end %>
